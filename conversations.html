<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conversation</title>

    <!-- Import styles from view-details.html -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/editor-quill.css">
    <link rel="stylesheet" href="assets/css/file-upload.css">
    <link rel="stylesheet" href="assets/css/jquery-ui.css">
    <link rel="stylesheet" href="assets/css/jquery-jvectormap-2.0.5.css">
    <link rel="stylesheet" href="assets/css/plyr.css">



</head>

<body>
    <div class="dashboard-main-wrapper">
        <!-- Sidebar (same as view-details.html) -->
        <aside class="sidebar">
            <a href="index.html" class="sidebar__logo text-center p-20">
                <img src="assets/images/logo/fun_logo.png" alt="Logo">
            </a>
            <div class="sidebar-menu-wrapper">
                <ul class="sidebar-menu">
                    <li><a href="index.html" class="sidebar-menu__link">Accueil</a></li>
                    <li><a href="student-courses.html" class="sidebar-menu__link">Cours</a></li>
                    <li><a href="support-cours.html" class="sidebar-menu__link">Supports de cours</a></li>
                    <li><a href="students.html" class="sidebar-menu__link">Apprenants</a></li>
                    <li><a href="email.html" class="sidebar-menu__link">Boîte de réception</a></li>
                </ul>
            </div>
        </aside>

        <!-- Main Dashboard Content -->
        <div class="dashboard-body">
            <!-- Breadcrumb (same as view-details.html) -->
            <div class="breadcrumb mb-24">
                <ul class="flex-align gap-4">
                    <li><a href="index.html" class="text-gray-200 fw-normal text-15 hover-text-main-600">Home</a></li>
                    <li><i class="ph ph-caret-right"></i></li>
                    <li><span class="text-main-600 fw-normal text-15">Conversation</span></li>
                </ul>
            </div>

            <!-- Email Section -->
            <div class="row gy-4">
                <!-- Sidebar for Emails -->
                <div class="col-xl-3">
                    <div class="card h-100 p-0">
                        <div class="card-body p-24">
                            <button class="btn btn-main text-sm w-100 mb-16">Compose</button>
                            <ul>
                                <li class="mb-8 email-links">
                                    <a href="email.html" class="hover-bg-main-50 px-20 py-8 rounded-pill text-gray-300 hover-text-gray-600">Inbox</a>
                                </li>
                                <li class="mb-8 email-links">
                                    <a href="starred.html" class="hover-bg-main-50 px-20 py-8 rounded-pill text-gray-300 hover-text-gray-600">Starred</a>
                                </li>
                                <li class="mb-8 email-links">
                                    <a href="#" class="hover-bg-main-50 px-20 py-8 rounded-pill text-gray-300 hover-text-gray-600">Sent</a>
                                </li>
                                <li class="mb-8 email-links">
                                    <a href="#" class="hover-bg-main-50 px-20 py-8 rounded-pill text-gray-300 hover-text-gray-600">Draft</a>
                                </li>
                                <li class="mb-8 email-links">
                                    <a href="#" class="hover-bg-main-50 px-20 py-8 rounded-pill text-gray-300 hover-text-gray-600">Spam</a>
                                </li>
                                <li>
                                    <a href="#" class="hover-bg-main-50 px-20 py-8 rounded-pill text-gray-300 hover-text-gray-600">Bin</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Conversation Section -->
                <div class="col-xl-9">
                    <div class="card">
                        <div class="card-header py-16 flex-between">
                            <div class="d-flex align-items-center gap-8">
                                <a href="email.html" class="text-gray-600 hover-text-main-600 d-flex me-8 text-2xl">
                                    <i class="ph ph-arrow-left"></i>
                                </a>
                                <h6 id="conversation-title" class="mb-0 text-lg">Loading...</h6>
                            </div>
                        </div>
                        <div class="card-body p-0" id="conversation-messages">
                            <!-- Messages will be dynamically inserted here -->
                        </div>
                        <div class="card-footer border-top">
                            <form class="flex-align gap-8">
                                <label for="fileUp" class="file-btn w-48 h-48 flex-center bg-main-50 text-24 text-main-600 rounded-circle hover-bg-main-100">
                                    <i class="ph ph-plus"></i>
                                </label>
                                <input type="file" id="fileUp" hidden>
                                <input type="text" class="form-control h-48" placeholder="Type your message...">
                                <button type="submit" class="btn btn-main">Envoyer</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer (same as view-details.html) -->
        <div class="dashboard-footer">
            <div class="flex-between">
                <p class="text-gray-300 text-13 fw-normal"> &copy; Copyright Fan 2024, All Rights Reserved</p>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Get the conversation ID from the URL
        const params = new URLSearchParams(window.location.search);
        const conversationId = params.get('id');

        // Fetch the JSON file
        fetch('assets/data/modifiedStagaireLinks.json')
            .then(response => response.json())
            .then(data => {
                const conversation = data.find(person => person.link.includes(conversationId));
                if (conversation) {
                    // Set the conversation title
                    document.getElementById('conversation-title').textContent = `${conversation.PRENOM} ${conversation.NOM}`;

                    // Define dynamic messages
                    const messages = [
                        {
                            sender: 'Vous',
                            message: `<a href="${conversation.link}">Lien drive ici</a>`,
                            type: 'vous',
                            timestamp: '2024-11-22T09:00:00'
                        },
                        {
                            sender: `${conversation.PRENOM}`,
                            message: 'Merci beaucoup !',
                            type: 'participant',
                            timestamp: '2024-11-22T09:05:00'
                        }
                    ];

                    const messagesContainer = document.getElementById('conversation-messages');
                    messages.forEach(msg => {
                        const messageEl = document.createElement('div');
                        messageEl.innerHTML = `
                            <div class="p-3 border-bottom">
                                <strong>${msg.sender}:</strong> ${msg.message}
                                <div class="text-muted">${new Date(msg.timestamp).toLocaleTimeString()}</div>
                            </div>`;
                        messagesContainer.appendChild(messageEl);
                    });
                } else {
                    document.getElementById('conversation-title').textContent = 'Conversation Not Found';
                }
            })
            .catch(error => console.error('Error fetching conversation:', error));
    </script>
</body>

</html>